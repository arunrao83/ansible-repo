  - hosts: elasticsearch_master
    become: yes
#    become_method: sudo
    roles:
      - { role: elasticsearch, es_instance_name: "master", es_heap_size: "1g",
      es_config: {
          cluster.name: "test-cluster",
          discovery.zen.ping.unicast.hosts: "{{ hostvars[groups['elasticsearch_master'][0]]['ansible_eth0']['ipv4']['address'] }}",
          http.port: 9200,
          transport.tcp.port: 9300,
          node.data: false,
          node.master: true,
          network.host: [_site_,_local_],
          bootstrap.mlockall: false,
          discovery.zen.ping.multicast.enabled: false }
      }
    vars:
      es_scripts: false
      es_templates: false
      es_version_lock: false
      ansible_user: ansible
      es_start_service: true
      es_plugins:
       - plugin: elasticsearch/license
         version: latest

  - hosts: elasticsearch_data
    become: yes
#    become_method: sudo
    roles:
      - { role: elasticsearch, es_instance_name: "data", es_heap_size: "1g",
      es_config: {
        discovery.zen.ping.unicast.hosts: "{{ hostvars[groups['elasticsearch_master'][0]]['ansible_eth0']['ipv4']['address'] }}",
        http.port: 9200,
        transport.tcp.port: 9300,
        node.data: true,
        node.master: false,
        bootstrap.mlockall: false,
        cluster.name: "test-cluster",
        network.host: [_site_,_local_],
        discovery.zen.ping.multicast.enabled: false }
      }
    vars:
      es_scripts: false
      es_templates: false
      es_version_lock: false
      es_start_service: true
      es_plugins:
       - plugin: elasticsearch/license
         version: latest

